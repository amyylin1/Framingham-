---
output:
  html_document: default
  pdf_document: default
---


I. Reading in the data

```{r}
fhs.df <- read.csv('framingham.csv')
#fhs.df[ 1:10, 1:16 ]
#fhs.df
```

## dimension of the matrix

```{r}
dim( fhs.df )
```

The data frame is a 16 by 4240 matrix.

There are 15 variables (columns), excluding the index. 

There are 4240 subjects. 

## variable names

```{r}
# what are the variable names
names( fhs.df )
```

## attach dataset

```{r}
# link to dataset
attach( fhs.df )
```


# II. Model building

We will start with a forward selection strategy first.  If this does not lead to the model with the best goodness of fit, we will consider alternative model along the way. 

The variables we have are :  
      
      sex, age
      
      Education
      
      CurrentSmoker, cigsPerday, heartRate
      
      PrevalentStroke, prevalentHyp, BPMeds
      
      diabetes
      
      glucose, totChol, BMI
      
We will build a simple linear model for the our defined response variable, using only the explanatory variables (or functions of them):

      CurrentSmoker, cigsPerday
      
Once we have a model in term of these two confounding confounding variables, we will add:

      BPMeds 


## - response variable 

Blood pressure is an health measure of cardiovascular function.  In general, high blood pressure indicates poor vascular health, and lower blood pressure indicates otherwise. The ideal blood pressure reading is less than 120/80 mmHg.   

General guidelines:

Normal:  less than 120/80 mmHg

Elevated:  120/129 / <80 mmHg

Hypertension status 1:  130-139 / 80-90 mmHg

Hypertension status 2: 140 or higher / 90 or higher mmHg

we decide to make our response variable as the difference between of the systolic blood pressure and the diastolic blood pressure. 

When blood pressure is taken, systolic and diastolic blood pressures are measured. 

      1. Systolic pressure (the top number in the blood pressure reading) measures the pressure of the arteries when the heart push the oxygenated blood out into the circulatory system during the contraction phase.
      
      2. Dystolic pressure (the bottom number in the blood pressure reading) measures the pressure of the arteries in between contraction, when the heart is at the relaxation phase. 
      
```{r}
# define the difference bet. systolic and dystolic pressure
bpd = sysBP - diaBP 
#bp.df

# create the log.bpd variable
log.bpd = log(bpd)
```

## - age model 

Does age has to do with cardiovascular health?  

In theory, yes, because age is a risk factor for age-related cardiovascular declines. 

```{r}
age.model <- lm ( log.bpd ~ age )
summary( age.model )
anova( age.model )
```

### plot 

```{r}
plot( age, log.bpd )
```

# - gender model 

Does gender contribute to heart health?

```{r}
# is.female equals to 0 if the gender is female, 1 otherwise. 
is.female <- ifelse( male == 1, 0, 1 )
#is.female 
```

```{r}
gender.model <- lm( log.bpd ~ is.female )
summary( gender.model )
anova( gender.model )
```

```{r}
#plot <- (is.female, log.bpd )
```

## - bmi model 

```{r}
BMI.model <- lm( log.bpd ~ fhs.df$BMI )
summary(BMI.model)
anova(BMI.model)
```
The p-value is 2e-16.

```{r}
#fhs.df$BMI
```

```{r}
plot(BMI, log.bpd)
```

## - diabetets model

```{r}
# is.diabetes equals to 1 if the diabetic status is yes, 0 otherwise.
is.diabetes <- ifelse( diabetes == 1, 1, 0 )
is.diabetes
```

```{r}
fhs.df$diabetes
```

```{r}
diabetic.model <- lm( log.bpd  ~ fhs.df$diabetes )
summary(diabetic.model)
anova(diabetic.model)
```

```{r}
# Assuming fhs.df$diabetes is a binary variable indicating diabetic status (0 for non-diabetic, 1 for diabetic)

# Assign colors based on diabetic status
colors <- c("non-diabetic" = "blue", "diabetic" = "red")
point_colors <- colors[fhs.df$diabetes + 1]  # Adding 1 to convert 0/1 to 1/2 for indexing colors

# Plot log.bpd against diabetes status
plot(log.bpd, fhs.df$diabetes, col = point_colors, pch = 19, xlab = "Log(Blood Pressure)", ylab = "Diabetes Status")

# Add legend
legend("topright", legend = c("Non-Diabetic", "Diabetic"), col = colors, pch = 19)

```

```{r}
diabetic.count <- sum(fhs.df$diabetes == 1 )
diabetic.count
```

```{r}
nondiabetic.count <- sum(fhs.df$diabetes == 0 )
nondiabetic.count
```

1/40 of people are diabetic in this study

```{r}
# Example data


# Convert diabetes to a factor for color assignment
fhs.df$diabetes_factor <- factor(fhs.df$diabetes, levels = c(0, 1), labels = c("non-diabetic", "diabetic"))

# Create a color vector based on diabetes_factor
colors <- c("non-diabetic" = "blue", "diabetic" = "red")
point_colors <- colors[fhs.df$diabetes_factor]

# Plot BMI against log.bpd, color by diabetic status
plot(fhs.df$BMI, fhs.df$log.bpd, col = point_colors, pch = 19, xlab = "BMI", ylab = "Log(Blood Pressure)")
legend("topright", legend = levels(fhs.df$diabetes_factor), col = colors, pch = 19, title = "Diabetic Status")

```


# glu. model

```{r}
glucose.model <- lm( heartRate ~ glucose )
summary(glucose.model)
anova( glucose.model)
```
```{r}
cigar.model <- lm( heartRate ~ cigsPerDay )
summary(cigar.model)
anova(cigar.model)
```
# sysBP



##  smoking model

```{r}
# is.smoker equals to 1 if the the individual currently smokes, 0 otherwise.
is.smoker <- ifelse( currentSmoker == 1, 1, 0 )
#is.smoker 
```

```{r}
smoking.model <- lm ( log.bpd ~ is.smoker )
summary( smoking.model )
anova( smoking.model )
```

## - cholestrol model

```{r}
chol.model <- lm( log.bpd ~ totChol )
summary(chol.model)
anova(chol.model)
```


